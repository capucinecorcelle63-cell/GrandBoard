{% extends 'base.html' %}
{% block content %}
<div class="container py-4">
  <h2 class="mb-4">Ajouter/Modifier une catégorie</h2>
  <div class="row">
    <div class="col-md-6">
      <form method="post">
        <input type="hidden" name="action" value="add">
        <div class="mb-3">
          <label for="new_name" class="form-label">Nom de la nouvelle catégorie</label>
          <input type="text" name="name" id="new_name" class="form-control" maxlength="80" placeholder="Nouvelle catégorie">
        </div>
        <button type="submit" class="btn btn-primary">Ajouter</button>
      </form>
    </div>
    <div class="col-md-6">
      <form method="get">
        <label for="cat_select" class="form-label">Catégories existantes</label>
        <select name="id" id="cat_select" class="form-select" onchange="this.form.submit()">
          <option value="">-- Choisir --</option>
          {% for cat in categories %}
            <option value="{{ cat.id }}" {% if selected_cat and selected_cat.id == cat.id %}selected{% endif %}>{{ cat.name }}</option>
          {% endfor %}
        </select>
      </form>
      {% if selected_cat %}
        <form method="post" class="mt-3">
          <input type="hidden" name="action" value="edit">
          <input type="hidden" name="id" value="{{ selected_cat.id }}">
          <div class="mb-3">
            <label for="edit_name" class="form-label">Modifier le nom</label>
            <input type="text" name="name" id="edit_name" class="form-control" maxlength="80" value="{{ selected_cat.name }}">
          </div>
          <button type="submit" class="btn btn-success">Modifier</button>
        </form>
        <form method="post" class="mt-2">
          <input type="hidden" name="action" value="delete">
          <input type="hidden" name="id" value="{{ selected_cat.id }}">
          <button type="submit" class="btn btn-danger" onclick="return confirm('Supprimer cette catégorie ?')">Supprimer</button>
        </form>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
